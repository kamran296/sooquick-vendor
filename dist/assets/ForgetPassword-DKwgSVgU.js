import{a,u as V,j as e,L as z,e as S,b as m,y as o}from"./index-D4jZjNgn.js";import{F as B,a as O}from"./index-HyJOQJdU.js";import"./iconBase-BYpTOd7S.js";const W=()=>{const[i,h]=a.useState("email"),[n,R]=a.useState(""),[d,b]=a.useState(["","","",""]),[l,u]=a.useState(59),[c,E]=a.useState(""),[p,C]=a.useState(""),[f,y]=a.useState(!1),[w,j]=a.useState(!1),[x,v]=a.useState(!1),[g,N]=a.useState(!1),F=V();a.useEffect(()=>{if(i==="otp"&&l>0){const s=setInterval(()=>u(t=>t-1),1e3);return()=>clearInterval(s)}},[i,l]);const L=s=>{R(s.target.value)},T=async s=>{if(s.preventDefault(),!!n){y(!0);try{const t=await m.requestOtp({email:n});console.log(t,"Otp request response"),h("otp"),u(59)}catch(t){const r=t.response?.data?.message||t.message||"Failed to send OTP";o.error(r),console.error("Failed to send OTP:",r)}finally{y(!1)}}},q=(s,t)=>{if(!/^\d?$/.test(s))return;const r=[...d];r[t]=s,b(r),s&&t<3&&document.getElementById(`otp-${t+1}`)?.focus()},$=async()=>{if(l===0&&n){v(!0);try{b(["","","",""]),u(59);const s=await m.requestOtp({email:n});console.log(s,"resend otp response")}catch(s){const t=s.response?.data?.message||s.message||"Failed to resend OTP";o.error(t),console.error("Resend OTP failed:",t)}finally{v(!1)}}},k=async()=>{const s=d.join("");if(!(!n||s.length!==4)){j(!0);try{const t=await m.verifyOtp({email:n,otp:s});console.log(t,"verify otp response"),o.success("OTP verified, proceed to reset password"),h("reset")}catch(t){const r=t.response?.data?.message||t.message||"OTP verification failed";o.error(r),console.error("OTP verification failed:",r)}finally{j(!1)}}},M=async s=>{if(s.preventDefault(),!c||!p){o.error("Both fields are required");return}if(c!==p){o.error("Passwords do not match");return}N(!0);try{const t=await m.changePassword({email:n,password:c});console.log(t,"password changes"),o.success("Password has been reset successfully"),F(S.login)}catch(t){const r=t.response?.data?.message||t.message||"Failed to reset password";o.error(r),console.error("Reset password error:",r)}finally{N(!1)}},P=d.every(s=>s.length===1);return e.jsx("div",{className:"font-mont flex min-h-screen w-full items-center justify-center px-4 py-10",children:e.jsxs("div",{className:"w-full max-w-md",children:[i==="email"&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Reset Your Password"}),e.jsx("p",{className:"mt-1 mb-6 text-sm text-gray-500",children:"Enter your email to reset your password"}),e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 rounded-full border border-gray-200 bg-gray-100 px-4 py-3 text-sm text-[#808080]",children:[e.jsx(B,{size:18}),e.jsx("input",{type:"email",name:"email",value:n,onChange:L,placeholder:"Email Address",required:!0,className:"w-full bg-transparent text-[#808080] placeholder-[#808080] focus:outline-none"})]}),e.jsx("button",{type:"submit",disabled:f,className:`w-full rounded-full py-3 font-semibold text-white transition ${f?"cursor-not-allowed bg-gray-400":"bg-[#0b8263] hover:bg-teal-800"}`,children:f?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}),"Sending..."]}):"Verify Your Email"})]}),e.jsx("div",{className:"mt-3 flex w-full items-end justify-end",children:e.jsx(z,{to:S.login,className:"font-medium text-blue-600 underline",children:"Back"})})]}),i==="otp"&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Verification Code"}),e.jsxs("p",{className:"mt-1 mb-6 w-[90%] text-sm text-gray-500",children:["We have sent the OTP to"," ",e.jsx("span",{className:"font-medium",children:n})," for the verification process."]}),e.jsx("div",{className:"mx-auto mb-4 flex w-fit justify-between gap-3",children:d.map((s,t)=>e.jsx("input",{id:`otp-${t}`,type:"text",maxLength:1,value:s,onChange:r=>q(r.target.value,t),className:"h-12 w-12 rounded-[16px] border border-gray-300 text-center text-xl focus:outline-blue-500"},t))}),e.jsx("p",{className:"mb-4 text-center text-sm text-gray-500",children:l>0?e.jsxs(e.Fragment,{children:["Resend in 00:",l.toString().padStart(2,"0")]}):e.jsx("button",{onClick:$,disabled:x||l>0,className:`text-blue-600 underline ${x?"cursor-not-allowed opacity-50":""}`,children:x?"Resending...":"Resend"})}),e.jsx("button",{onClick:k,disabled:!P||w,className:`w-full rounded-full py-3 font-semibold text-white transition ${P?"bg-[#0b8263] hover:bg-teal-800":"cursor-not-allowed bg-gray-200"}`,children:w?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}),"Verifying..."]}):"Verify Email"})]}),i==="reset"&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Set New Password"}),e.jsx("p",{className:"mt-1 mb-6 text-sm text-gray-500",children:"Enter your new password below."}),e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 rounded-full border border-gray-200 bg-gray-100 px-4 py-3 text-sm text-[#808080]",children:[e.jsx(O,{size:18}),e.jsx("input",{type:"password",value:c,onChange:s=>E(s.target.value),placeholder:"New Password",required:!0,className:"w-full bg-transparent text-[#808080] placeholder-[#808080] focus:outline-none"})]}),e.jsxs("div",{className:"flex items-center gap-3 rounded-full border border-gray-200 bg-gray-100 px-4 py-3 text-sm text-[#808080]",children:[e.jsx(O,{size:18}),e.jsx("input",{type:"password",value:p,onChange:s=>C(s.target.value),placeholder:"Confirm Password",required:!0,className:"w-full bg-transparent text-[#808080] placeholder-[#808080] focus:outline-none"})]}),e.jsx("button",{type:"submit",disabled:g,className:`w-full rounded-full py-3 font-semibold text-white transition ${g?"cursor-not-allowed bg-gray-400":"bg-[#0b8263] hover:bg-teal-800"}`,children:g?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}),"Resetting..."]}):"Reset Password"})]})]})]})})};export{W as default};
