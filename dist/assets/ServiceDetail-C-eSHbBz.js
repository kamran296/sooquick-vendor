import{u as M,g as W,a,c as q,s as B,j as e,S as R,b as N,y as h}from"./index-DY_vMsxx.js";import{U as u}from"./UserLayout-DzFdZyvx.js";import{A as g,b as y,B as _,C as U,D as w,y as O}from"./index-C19mZZ1v.js";import{E as V}from"./EditServiceForm-CqClT3am.js";import{b as Y}from"./index-C1cnXVah.js";import"./iconBase-BnsnIT86.js";import"./App-CsXzvAq8.js";const Z=()=>{const n=M(),{id:k}=W(),d=k,[s,S]=a.useState(null),[C,f]=a.useState(!0),[b,E]=a.useState(""),[j,o]=a.useState(0),[v,m]=a.useState(!1),[l,x]=a.useState("description"),[p,c]=a.useState(!1),A=q();a.useEffect(()=>{A(B(1))},[]);const D=async t=>{try{f(!0);const i=await(await N.getServiceDetails(t)).data;i&&S(i.service)}catch(r){E("Failed to fetch service details"),console.error("Error fetching service:",r)}finally{f(!1)}};a.useEffect(()=>{d&&D(d)},[d]);const F=()=>{s&&s.documents&&s.documents.photos&&o(t=>(t+1)%s.documents.photos.length)},P=()=>{s&&s.documents&&s.documents.photos&&o(t=>(t-1+s.documents.photos.length)%s.documents.photos.length)},$=a.useMemo(()=>{if(!s)return null;switch(l){case"description":return e.jsxs("div",{className:"font-mont rounded-lg bg-white p-6 shadow-sm",children:[e.jsx("div",{className:"prose max-w-none",children:e.jsx("div",{className:"leading-relaxed whitespace-pre-line text-gray-700",children:s.fullDescription||s.description})}),e.jsx("div",{className:"my-6 border-t border-gray-200"}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 font-semibold text-gray-900",children:"Service Details"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 text-sm md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Category:"}),e.jsx("span",{className:"ml-2 font-medium",children:s.mainCategory})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Category:"}),e.jsx("span",{className:"ml-2 font-medium",children:s.category})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Availability:"}),e.jsx("span",{className:"ml-2 font-medium",children:s.availability})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Working Time:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[s.workingStartTime," - ",s.workingEndTime]})]})]})]})]});case"features":return e.jsxs("div",{className:"font-mont rounded-lg bg-white p-6 shadow-sm",children:[e.jsx("h3",{className:"mb-4 font-semibold text-gray-900",children:"Scope Of Work"}),e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:e.jsx("p",{className:"text-gray-500",children:s.scopeOfWork})})]});case"reviews":return e.jsx("div",{className:"font-mont rounded-lg bg-white p-6 shadow-sm",children:s.reviews&&s.reviews.length>0?e.jsx("div",{className:"space-y-6",children:s.reviews.map(t=>e.jsx("div",{className:"border-b border-gray-200 pb-6 last:border-0 last:pb-0",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-blue-100 font-semibold text-blue-800",children:t.user?.name?.[0]||"U"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:t.user?.name||"Anonymous"}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:5}).map((r,i)=>e.jsx(g,{className:`h-4 w-4 ${i<t.rating?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},i))}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(t.date).toLocaleDateString()})]}),e.jsx("p",{className:"leading-relaxed text-gray-700",children:t.comment})]})]})},t._id))}):e.jsx("p",{className:"text-gray-500",children:"No reviews yet."})});default:return null}},[l,s]);if(C)return e.jsx(u,{children:e.jsx("div",{className:"font-mont flex items-center justify-center bg-gray-50",children:e.jsx(R,{})})});if(b||!s)return e.jsx(u,{children:e.jsx("div",{className:"font-mont flex h-full w-full items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"mb-4 text-2xl font-bold text-gray-800",children:b||"Service not found"}),e.jsxs("button",{onClick:()=>n("/services"),className:"flex items-center justify-center rounded-md bg-[#0b8263] px-4 py-2 text-white hover:bg-teal-700",children:[e.jsx(y,{className:"mr-2"}),"Back to Services"]})]})})});const T=t=>{c(!1),h.success("Service edited!")},I=()=>{c(!1)},L=async()=>{if(window.confirm("Are you sure you want to delete this service? This action cannot be undone."))try{await N.deleteService(s._id),h.success("Service deleted successfully"),n("/services")}catch(r){console.error("Delete failed:",r),h.error("Failed to delete service")}};return e.jsx(u,{children:e.jsxs("div",{className:"font-mont bg-gray-50",children:[e.jsx("div",{className:"border-b border-gray-200 bg-white",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("button",{onClick:()=>n("/services"),className:"mb-4 flex items-center text-blue-600 hover:text-blue-800",children:[e.jsx(y,{className:"mr-2"}),"Back to Services"]})})}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"relative aspect-video overflow-hidden rounded-lg bg-gray-200",children:v?e.jsxs("div",{className:"relative flex h-full w-full items-center justify-center bg-black",children:[e.jsx("video",{controls:!0,className:"h-full w-full object-contain",src:`https://api.sooquick.com${s.documents.video[0]}`}),e.jsx("button",{onClick:()=>m(!1),className:"absolute top-4 right-4 flex h-10 w-10 items-center justify-center rounded-full bg-black/50 text-xl text-white hover:text-gray-300",children:"✕"})]}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:` https://api.sooquick.com${s.documents.photos[j]}`||"/placeholder-image.jpg",alt:s.serviceName,className:"h-full w-full object-cover"}),s.documents.photos.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:P,className:"absolute top-1/2 left-2 flex h-10 w-10 -translate-y-1/2 items-center justify-center rounded-full bg-black/50 text-white hover:bg-black/70",children:e.jsx(_,{className:"h-5 w-5"})}),e.jsx("button",{onClick:F,className:"absolute top-1/2 right-2 flex h-10 w-10 -translate-y-1/2 items-center justify-center rounded-full bg-black/50 text-white hover:bg-black/70",children:e.jsx(U,{className:"h-5 w-5"})})]}),s.documents.video&&s.documents.video.length>0&&e.jsx("button",{onClick:()=>m(!0),className:"absolute top-4 right-4 flex h-12 w-12 items-center justify-center rounded-full bg-black/50 text-white hover:bg-black/70",children:e.jsx(w,{className:"h-6 w-6"})})]})}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[s.documents.photos.map((t,r)=>e.jsx("button",{onClick:()=>o(r),className:`aspect-video w-20 flex-shrink-0 overflow-hidden rounded-md border-2 ${r===j?"border-blue-500":"border-transparent"}`,children:e.jsx("img",{src:`https://api.sooquick.com${t}`,alt:`${s.serviceName} ${r+1}`,className:"h-full w-full object-cover"})},r)),s.documents.video&&s.documents.video.length>0&&e.jsx("button",{onClick:()=>m(!0),className:`relative aspect-video w-20 flex-shrink-0 overflow-hidden rounded-md border-2 ${v?"border-blue-500":"border-transparent"}`,children:e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-gray-200",children:e.jsx(w,{className:"h-4 w-4 text-gray-600"})})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 flex items-start justify-between",children:e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s.serviceName})}),s.isApproved==="rejected"&&e.jsx("div",{className:"mb-4 rounded-lg border border-red-300 bg-red-50 p-4",children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-700",children:"❌ Service Rejected"}),e.jsxs("p",{className:"mt-1 text-sm text-red-600",children:[e.jsx("span",{className:"font-medium",children:"Reason:"})," ",s.rejectionMessage||"No reason provided"]}),e.jsx("p",{className:"mt-2 text-xs text-gray-600",children:"You can edit this service to fix the issues or delete it and create a new one."})]})})}),e.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(g,{className:"h-5 w-5 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"font-semibold",children:s.rating}),e.jsxs("span",{className:"text-gray-500",children:["(",s.reviewCount||"0"," reviews)"]})]}),e.jsx("span",{className:"rounded-full bg-blue-100 px-3 py-1 text-sm font-medium text-blue-800",children:s.category}),e.jsx("span",{className:"rounded-full bg-gray-100 px-3 py-1 text-sm font-medium text-gray-800",children:s.subCategory})]}),e.jsx("p",{className:"leading-relaxed text-gray-600",children:s.description})]}),e.jsxs("div",{className:"rounded-lg bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[e.jsxs("span",{className:"text-3xl font-bold text-blue-600",children:["₹",s.finalPrice]}),s.originalPrice&&s.originalPrice>s.finalPrice&&e.jsxs("span",{className:"text-lg text-gray-500 line-through",children:["₹",s.originalPrice]})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Availability:"}),e.jsx("span",{className:"ml-2 font-medium",children:s.availability})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Working hours:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[s.workingStartTime,"-",s.workingEndTime]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-3",children:[s.isApproved!=="requested"&&e.jsxs("button",{onClick:()=>c(!p),className:"flex w-full items-center justify-center rounded-md border border-gray-300 px-4 py-3 hover:bg-gray-50",children:[e.jsx(Y,{className:"mr-2"}),"Edit service"]}),s.isApproved==="rejected"&&e.jsxs("button",{onClick:L,className:"flex w-full items-center justify-center rounded-md border border-gray-300 px-4 py-3 hover:bg-red-500",children:[e.jsx(O,{className:"mr-2"})," Delete"]})]})]}),e.jsx("div",{className:"rounded-lg bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[e.jsxs("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-blue-100 font-semibold text-blue-800",children:[s.vendor.firstName?.[0],s.vendor.lastName?.[0]]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900",children:[s.vendor.firstName," ",s.vendor.lastName]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[e.jsx(g,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:s.vendor.rating}),e.jsxs("span",{children:["(",s.vendor.completedOrders||"0"," orders)"]})]})]})]})}),e.jsxs("div",{className:"rounded-lg bg-white p-4 shadow-sm",children:[e.jsx("h3",{className:"mb-2 font-semibold text-gray-900",children:"Earnings Breakdown"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:["Service Price: ₹",s.finalPrice]}),e.jsxs("p",{children:["Platform Fee: ₹",s.vendorPlatformFee]}),e.jsxs("p",{className:"font-semibold text-green-600",children:["You Earn: ₹",s.finalPrice-s.vendorPlatformFee]})]})]}),s.serviceAreas&&s.serviceAreas.length>0&&e.jsxs("div",{className:"rounded-lg bg-white p-6 shadow-sm",children:[e.jsx("h3",{className:"mb-3 font-semibold text-gray-900",children:"Service Areas"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.serviceAreas.map(t=>e.jsxs("span",{className:"rounded bg-gray-100 px-2 py-1 text-xs font-medium text-gray-800",children:[t.areaName,", ",t.city," - ",t.pincode]},t._id))})]})]})]}),e.jsxs("div",{className:"mt-12",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsx("button",{onClick:()=>x("description"),className:`border-b-2 px-1 py-4 text-sm font-medium ${l==="description"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"}`,children:"Description"}),e.jsx("button",{onClick:()=>x("features"),className:`border-b-2 px-1 py-4 text-sm font-medium ${l==="features"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"}`,children:"What's Included"}),e.jsx("button",{onClick:()=>x("reviews"),className:`border-b-2 px-1 py-4 text-sm font-medium ${l==="reviews"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"}`,children:"Reviews"})]})}),e.jsx("div",{className:"mt-6",children:$}),p&&e.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black/30 p-4",children:e.jsxs("div",{className:"relative max-h-[90vh] w-full max-w-4xl overflow-y-auto rounded-lg bg-white",children:[e.jsxs("div",{className:"sticky top-0 flex items-center justify-between border-b bg-white p-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Edit Service"}),e.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4",children:e.jsx(V,{serviceId:s._id,onSuccess:T,onCancel:I,service:s})})]})})]})]})]})})};export{Z as default};
