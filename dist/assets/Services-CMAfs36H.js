import{c as P,d as C,j as e,x as I,a as c,s as L,u as T,b as S,z as R,y as E,A as B,B as O}from"./index-C1EYxzDL.js";import{U as V}from"./UserLayout-DWzGO_-9.js";import{P as $,E as z}from"./EditServiceForm-TDOqCbz3.js";import{z as M,y as U,b as H}from"./index-1zIfoPQQ.js";import"./iconBase-DoOu_9lG.js";import"./index-DX2SoyJM.js";const K=()=>{const s=P(),a=C(i=>i.service.serviceTabActive),{requestedCount:u,rejectedCount:h,totalServices:g}=C(i=>i.service),x=[{id:0,name:"My Services",path:"/",count:g},{id:1,name:"Post Services",path:"/",count:0},{id:2,name:"Pending Approvals",path:"/",count:u||0},{id:3,name:"Rejected Services",path:"/",count:h||0}],f=i=>{s(I(i))};return e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-4",children:x.map(i=>e.jsxs("button",{onClick:()=>f(i.id),className:`flex items-center justify-between rounded-lg border p-3 transition-all duration-200 ${a===i.id?"border-teal-500 bg-teal-50 shadow-sm":"border-gray-200 bg-white hover:border-gray-300"}`,children:[e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:`text-sm font-medium ${a===i.id?"text-teal-700":"text-gray-900"}`,children:i.name})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[i.count>0&&e.jsx("span",{className:`rounded-full px-2 py-1 text-xs font-medium ${i.name==="Pending Approvals"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:i.count}),a===i.id&&e.jsx("div",{className:"h-2 w-2 rounded-full bg-teal-500"})]})]},i.id))})})},Y=["Repair & Maintenance","Cleaning & Hygiene Services","Fitness & Grooming"],G={"Repair & Maintenance":["Electrician","Plumber","Carpenter","AC Repair","Appliance Repair","Painting","Pest Control","RO Service","Computer Repair","Internet Services"],"Cleaning & Hygiene Services":["Home Cleaning","Sofa Cleaning","Carpet Cleaning","Bathroom Cleaning","Kitchen Cleaning","Office Cleaning","Water Tank Cleaning"],"Fitness & Grooming":["Mehendi Services"]},_={Electrician:["Fan installation/repair","Light/LED fitting & wiring","Switchboard repair","New wiring / short-circuit fixing"],Plumber:["Pipe leakage repair","Tap & faucet replacement","Bathroom fitting","Blockage/Drain unclogging"],"Home Cleaning":["1BHK full home cleaning","2BHK full home cleaning","3BHK full home cleaning","Post-renovation cleaning"],"Salon Services":["Haircut & Styling","Facial","Hair Color","Manicure & Pedicure"],"Car Mechanic":["General servicing","Engine repair","Brake service","AC repair"]},J=({images:s,setImages:a,video:u,setVideo:h})=>{const g=[c.useRef(null),c.useRef(null),c.useRef(null),c.useRef(null)],x=c.useRef(null),f=(o,r)=>{const v=r.target.files[0];if(v&&v.type.startsWith("image/")){const w=[...s];w[o]=v,a(w)}},i=o=>{const r=o.target.files[0];r&&r.type.startsWith("video/")&&h(r)},l=o=>{g[o].current?.click()},p=()=>{x.current?.click()},b=o=>{const r=[...s];r[o]=null,a(r)},n=()=>{h(null)};return e.jsxs("div",{className:"font-mont space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-4 text-lg font-medium text-gray-700",children:"Upload Photos"}),e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[0,1,2,3].map(o=>e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:["Photo ",o+1]}),s[o]?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:URL.createObjectURL(s[o]),alt:`Preview ${o+1}`,className:"h-40 w-full rounded-lg border object-cover"}),e.jsx("button",{type:"button",onClick:()=>b(o),className:"absolute -top-2 -right-2 flex h-6 w-6 items-center justify-center rounded-full bg-red-500 text-xs text-white",children:"×"})]}):e.jsxs("div",{className:"flex h-40 cursor-pointer items-center justify-center rounded-lg border-2 border-dashed border-gray-300 p-4 text-center transition-all hover:border-teal-400 hover:bg-teal-50",onClick:()=>l(o),children:[e.jsx("input",{type:"file",ref:g[o],accept:"image/*",onChange:r=>f(o,r),className:"hidden"}),e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-teal-100",children:e.jsx("svg",{className:"h-6 w-6 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Click to upload"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"PNG, JPG, JPEG"})]})]})]})]},o))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-4 text-lg font-medium text-gray-700",children:"Upload Video"}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Video"}),u?e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex h-40 w-full items-center justify-center rounded-lg border bg-gray-200",children:e.jsx("svg",{className:"h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx("p",{className:"truncate text-sm text-gray-700",children:u.name}),e.jsx("button",{type:"button",onClick:n,className:"text-sm font-medium text-red-500",children:"Remove"})]})]}):e.jsxs("div",{className:"cursor-pointer rounded-lg border-2 border-dashed border-gray-300 p-6 text-center transition-all hover:border-teal-400 hover:bg-teal-50",onClick:p,children:[e.jsx("input",{type:"file",ref:x,accept:"video/*",onChange:i,className:"hidden"}),e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-3",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-teal-100",children:e.jsx("svg",{className:"h-6 w-6 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Click to upload video"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"MP4, MOV, AVI"})]}),e.jsx("button",{type:"button",className:"rounded-md bg-teal-600 px-3 py-1.5 text-xs text-white transition-colors hover:bg-teal-700",children:"Browse Files"})]})]})]})]})]})},Q=()=>{const[s,a]=c.useState({serviceName:"",mainCategory:"",category:"",serviceType:"",servicePrice:"",scopeOfWork:"",postalCodes:"",availability:"",workingStartTime:"",workingEndTime:"",workingDays:[]}),u=P();c.useEffect(()=>{u(L(1))},[]);const[h,g]=c.useState([null,null,null,null]),[x,f]=c.useState(null),[i,l]=c.useState(!1),[p,b]=c.useState(""),[n,o]=c.useState({}),[r,v]=c.useState([]),w=T(),d=C(t=>t.user),N=t=>{v(t)},j=t=>{const{name:m,value:k}=t.target;a(m==="mainCategory"?{...s,mainCategory:k,category:"",serviceType:""}:m==="category"?{...s,category:k,serviceType:""}:{...s,[m]:k}),n[m]&&o({...n,[m]:""})},D=()=>{const t={};return s.serviceName.trim()||(t.serviceName="Service name is required"),s.mainCategory||(t.mainCategory="Main category is required"),s.category||(t.category="Category is required"),s.serviceType.trim()||(t.serviceType="Service type is required"),(!s.servicePrice||parseFloat(s.servicePrice)<=0)&&(t.servicePrice="Valid service price is required"),s.scopeOfWork.trim()||(t.scopeOfWork="Scope of work is required"),r.length===0&&(t.serviceAreas="At least one service area is required"),s.availability||(t.availability="Availability is required"),o(t),Object.keys(t).length===0},W=async t=>{if(t.preventDefault(),!D()){b("Please fix the errors in the form");return}l(!0),b("");try{const m=new FormData;Object.keys(s).forEach(y=>{y!=="workingDays"&&m.append(y,s[y])}),m.append("serviceAreas",JSON.stringify(r)),m.append("workingDays",JSON.stringify(s.workingDays)),h.filter(y=>y!==null).forEach(y=>{m.append("images",y)}),x&&m.append("video",x);for(let[y,F]of m.entries())console.log(y,F);(await S.createService(m,{headers:{"Content-Type":"multipart/form-data"}})).data&&(b("Service created successfully! Waiting for admin approval."),a({serviceName:"",mainCategory:"",category:"",serviceType:"",servicePrice:"",scopeOfWork:"",postalCodes:"",availability:"",workingStartTime:"",workingEndTime:"",workingDays:[]}),v([]),g([null,null,null,null]),f(null),o({}),w("/services?tab=pending"))}catch(m){console.error("Error creating service:",m),b("Error creating service: "+(m.response?.data?.message||m.message))}finally{l(!1)}},q=t=>{a(m=>({...m,workingDays:m.workingDays.includes(t)?m.workingDays.filter(k=>k!==t):[...m.workingDays,t]}))};return d.kycVerified==="pending"?e.jsx("div",{className:"font-mont mb-6 rounded-lg border border-yellow-200 bg-yellow-50 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Complete KYC Verification"}),e.jsx("p",{className:"mt-1 text-sm text-yellow-700",children:"You need to complete KYC verification to start creating services."})]})]}),e.jsx("button",{onClick:()=>window.location.href="/kyc-verification",className:"rounded-md bg-yellow-600 px-4 py-2 text-sm font-medium text-white hover:bg-yellow-700 focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2 focus:ring-offset-yellow-50 focus:outline-none",children:"Complete KYC"})]})}):d.kycVerified==="requested"?e.jsx("div",{className:"font-mont mb-6 rounded-lg border border-blue-200 bg-blue-50 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"KYC Under Verification"}),e.jsx("p",{className:"mt-1 text-sm text-blue-700",children:"Your KYC documents are under verification. Once verified, you'll be able to create services."})]})]})}):e.jsxs("div",{className:"font-mont mx-auto mt-5 max-w-5xl rounded-lg bg-white p-6 shadow-md",children:[e.jsx("h2",{className:"mb-6 text-2xl font-bold text-gray-800",children:"Create New Service"}),e.jsxs("form",{onSubmit:W,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Service Name"}),e.jsx("input",{type:"text",name:"serviceName",value:s.serviceName,onChange:j,className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:border-teal-500 focus:ring-teal-500"}),n.serviceName&&e.jsx("p",{className:"text-xs text-red-500",children:n.serviceName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Main Category *"}),e.jsxs("select",{name:"mainCategory",value:s.mainCategory,onChange:j,className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:border-teal-500 focus:ring-teal-500",children:[e.jsx("option",{value:"",children:"Select Main Category"}),Y.map(t=>e.jsx("option",{value:t,children:t},t))]}),n.mainCategory&&e.jsx("p",{className:"text-xs text-red-500",children:n.mainCategory})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category *"}),e.jsxs("select",{name:"category",value:s.category,onChange:j,disabled:!s.mainCategory,className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:border-teal-500 focus:ring-teal-500 disabled:bg-gray-100",children:[e.jsx("option",{value:"",children:"Select Category"}),s.mainCategory&&G[s.mainCategory]?.map(t=>e.jsx("option",{value:t,children:t},t))]}),n.category&&e.jsx("p",{className:"text-xs text-red-500",children:n.category})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Service Type *"}),e.jsx("input",{type:"text",name:"serviceType",value:s.serviceType,onChange:j,className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:border-teal-500 focus:ring-teal-500",placeholder:"e.g., Fan installation/repair, Pipe leakage repair, 1BHK home cleaning",list:"serviceTypeSuggestions"}),e.jsx("datalist",{id:"serviceTypeSuggestions",children:s.category&&_[s.category]?.map((t,m)=>e.jsx("option",{value:t},m))}),n.serviceType&&e.jsx("p",{className:"text-xs text-red-500",children:n.serviceType}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Describe the specific service you offer"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Service Price (₹)"}),e.jsx("input",{type:"number",step:"10",min:0,name:"servicePrice",value:s.servicePrice,onChange:j,className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:border-teal-500 focus:ring-teal-500"}),n.servicePrice&&e.jsx("p",{className:"text-xs text-red-500",children:n.servicePrice})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Scope of Work"}),e.jsx("textarea",{name:"scopeOfWork",value:s.scopeOfWork,onChange:j,rows:3,className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:border-teal-500 focus:ring-teal-500"}),n.scopeOfWork&&e.jsx("p",{className:"text-xs text-red-500",children:n.scopeOfWork})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Postal Codes (comma separated)"}),e.jsx($,{onServiceAreasChange:N}),n.postalCodes&&e.jsx("p",{className:"text-xs text-red-500",children:n.postalCodes})]}),e.jsxs("div",{className:"pt-6",children:[e.jsx("h3",{className:"mb-3 text-lg font-medium text-gray-900",children:"Working Hours"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Availability"}),e.jsxs("select",{name:"availability",value:s.availability,onChange:j,className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:border-teal-500 focus:ring-teal-500",children:[e.jsx("option",{value:"",children:"Select Availability"}),e.jsx("option",{value:"Weekdays",children:"Weekdays"}),e.jsx("option",{value:"Weekends",children:"Weekends"}),e.jsx("option",{value:"Anytime",children:"Anytime"}),e.jsx("option",{value:"On Request",children:"On Request"})]}),n.availability&&e.jsx("p",{className:"text-xs text-red-500",children:n.availability})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Available Days"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map(t=>e.jsx("button",{type:"button",onClick:()=>q(t),className:`rounded-full px-3 py-1 text-sm font-medium transition-colors ${s.workingDays.includes(t)?"border border-teal-300 bg-teal-100 text-teal-800":"border border-gray-300 bg-gray-100 text-gray-800 hover:bg-gray-200"}`,children:t.substring(0,3)},t))})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Start Time"}),e.jsx("input",{type:"time",name:"workingStartTime",value:s.workingStartTime,onChange:j,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-teal-500 focus:ring-1 focus:ring-teal-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"End Time"}),e.jsx("input",{type:"time",name:"workingEndTime",value:s.workingEndTime,onChange:j,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none"})]})]})]}),e.jsx("div",{children:e.jsx(J,{images:h,setImages:g,video:x,setVideo:f})}),e.jsx("button",{type:"submit",disabled:i,className:"w-full rounded-md bg-[#0b8263] px-4 py-2 text-white hover:bg-teal-800 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:outline-none disabled:opacity-50",children:i?"Creating Service...":"Create Service"})]}),p&&e.jsx("div",{className:`rounded-md p-3 ${p.includes("Error")?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:p})]})},X=({service:s,onDelete:a,deleting:u})=>{const[h,g]=c.useState(0),[x,f]=c.useState(!1),[i,l]=c.useState(!1),p=T(),b=(d,N)=>(d-N)/N*100,n=()=>{g(d=>(d+1)%s.documents.photos.length)},o=()=>{g(d=>(d-1+s.documents.photos.length)%s.documents.photos.length)},r=s.documents.video&&s.documents.video.length>0,v=d=>{l(!1),console.log("Service updated successfully:",d)},w=()=>{l(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"group overflow-hidden rounded-lg bg-white shadow-md transition-all duration-300 hover:-translate-y-1 hover:shadow-lg md:min-w-[300px]",children:[e.jsx("div",{className:"relative aspect-video overflow-hidden",children:x?e.jsxs("div",{className:"relative flex h-full w-full items-center justify-center bg-black",children:[e.jsxs("video",{controls:!0,autoPlay:!0,className:"h-full w-full object-contain",poster:s.documents.photos[0],children:[e.jsx("source",{src:`https://api.sooquick.com${s.documents.video[0]}`,type:"video/mp4"}),"Your browser does not support the video tag."]}),e.jsx("button",{onClick:d=>{d.stopPropagation(),f(!1)},className:"absolute top-2 right-2 flex h-8 w-8 items-center justify-center rounded-full bg-black/50 text-white transition-colors hover:bg-black/70",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:`https://api.sooquick.com${s.documents.photos[h]}`||"/placeholder.svg",alt:s.serviceName,className:"h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"}),s.documents.photos.length>1&&e.jsx("div",{className:"absolute bottom-2 left-1/2 flex -translate-x-1/2 gap-1",children:s.documents.photos.map((d,N)=>e.jsx("button",{onClick:j=>{j.stopPropagation(),g(N)},className:`h-2 w-2 rounded-full transition-colors ${N===h?"bg-black":"bg-white/50"}`},N))}),r&&e.jsx("button",{onClick:d=>{d.stopPropagation(),f(!0)},className:"absolute top-2 right-2 flex h-8 w-8 items-center justify-center rounded-full bg-black/50 text-white transition-colors hover:bg-black/70",children:e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})}),s.documents.photos.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:d=>{d.stopPropagation(),o()},className:"absolute top-1/2 left-2 flex h-8 w-8 -translate-y-1/2 items-center justify-center rounded-full bg-black/50 text-white opacity-0 transition-colors group-hover:opacity-100 hover:bg-black/70",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{onClick:d=>{d.stopPropagation(),n()},className:"absolute top-1/2 right-2 flex h-8 w-8 -translate-y-1/2 items-center justify-center rounded-full bg-black/50 text-white opacity-0 transition-colors group-hover:opacity-100 hover:bg-black/70",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]})}),e.jsxs("div",{className:"p-4",onClick:d=>{p(`/service/${s._id}`)},children:[e.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsx("h3",{className:"line-clamp-2 font-semibold text-gray-900 transition-colors hover:text-teal-600",children:s.serviceName})}),e.jsx("div",{className:"status",children:s.isApproved==="requested"?e.jsxs("div",{className:"rounded-full bg-blue-200 px-3 py-[2px] text-center text-sm text-blue-400",children:[" ","Requested"]}):s.isApproved==="approved"?e.jsx("div",{className:"rounded-full bg-green-200 px-3 py-[2px] text-center text-sm text-green-400",children:"Approved"}):s.isApproved==="rejected"?e.jsx("div",{className:"rounded-full bg-red-200 px-3 py-[2px] text-center text-sm text-red-400",children:"Rejected"}):e.jsx("div",{className:"rounded-full bg-yellow-200 px-3 py-[2px] text-center text-sm text-yellow-400",children:"Pending"})})]}),e.jsx("p",{className:"mb-3 line-clamp-2 text-sm text-gray-600",children:s.description}),e.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.category})}),e.jsx("span",{className:"rounded-full bg-gray-100 px-2 py-1 text-xs text-gray-700",children:s.subCategory})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-md flex items-center font-bold text-teal-700",children:["Final Price: ",e.jsx(M,{}),s.finalPrice]}),e.jsxs("span",{className:"text-md flex items-center font-bold text-teal-700",children:["Original Price: ",e.jsx(M,{}),s.servicePrice]}),e.jsxs("span",{className:"text-md",children:["commision charges:",Math.floor(b(s.finalPrice,s.servicePrice)),"%"]}),s.isApproved==="rejected"&&s.rejectionMessage&&e.jsx("div",{className:"mt-3",children:e.jsxs("div",{className:"flex items-start gap-2 rounded-md bg-red-50 p-3",children:[e.jsx("svg",{className:"mt-0.5 h-4 w-4 flex-shrink-0 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.698-.833-2.464 0L4.232 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:"Rejection Reason:"}),e.jsx("p",{className:"mt-1 line-clamp-2 text-xs text-red-700",children:s.rejectionMessage})]})]})})]})}),e.jsxs("div",{className:"mt-6 flex space-x-4 border-t border-gray-200 pt-6",children:[s.isApproved!=="requested"&&e.jsx("button",{onClick:d=>{d.stopPropagation(),l(!0)},className:"rounded-lg bg-[#0b8263] px-6 py-2 text-white transition-colors hover:bg-teal-700",children:"Edit Service"}),s.isApproved==="rejected"&&e.jsx("button",{onClick:d=>{d.stopPropagation(),a(s._id)},disabled:u,title:"Delete Service",className:`rounded-lg border border-red-200 p-2 text-red-600 transition ${u?"cursor-not-allowed opacity-50":"hover:bg-red-50"}`,children:e.jsx(U,{})})]})]})]}),i&&e.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black/30 p-4",children:e.jsxs("div",{className:"relative max-h-[90vh] w-full max-w-4xl overflow-y-auto rounded-lg bg-white",children:[e.jsxs("div",{className:"sticky top-0 flex items-center justify-between border-b bg-white p-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Edit Service"}),e.jsx("button",{onClick:()=>l(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4",children:e.jsx(z,{serviceId:s._id,onSuccess:v,onCancel:w,service:s})})]})})]})},A=({filter:s="all"})=>{const{services:a}=C(r=>r.service),[u,h]=c.useState(null),[g,x]=c.useState(0),[f,i]=c.useState(!1),[l,p]=c.useState(null),b=P();c.useEffect(()=>{b(L(1))},[]);const n=c.useMemo(()=>{if(!a||a.length===0)return[];switch(s){case"all":return a;case"requested":return a.filter(r=>r.isApproved==="requested");case"rejected":return a.filter(r=>r.isApproved==="rejected");case"active":return a.filter(r=>r.isApproved==="approved");default:return a}},[a,s]),o=async r=>{try{p(r),await S.deleteService(r);const v=await S.getAllServices;b(R(v.data.services))}catch(v){console.error("Failed to delete service",v),E.error("Failed to delete service. Please try again.")}finally{p(null)}};return!a||a.length===0?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No services found. Create your first service to get started."}):n.length===0?e.jsxs("div",{className:"p-6 text-center text-gray-500",children:["No ",s!=="all"?s:""," services found."]}):e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"mb-6 text-2xl font-bold text-gray-800",children:s==="all"?"Your Services":s==="requested"?"Pending Approvals":s==="rejected"?"Rejected Services":`${s.charAt(0).toUpperCase()+s.slice(1)} Services`}),e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:n.map(r=>e.jsx(X,{service:r,onDelete:o,deleting:l===r._id},r._id||r.id))}),f&&u&&e.jsx(Z,{service:u,selectedImageIndex:g,onImageSelect:x,onClose:()=>{i(!1),h(null),x(0)}})]})},Z=({service:s,selectedImageIndex:a,onImageSelect:u,onClose:h})=>e.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black p-4",children:e.jsx("div",{className:"max-h-[90vh] w-full max-w-4xl overflow-y-auto rounded-xl bg-white",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-start justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:s.title}),e.jsx("button",{onClick:h,className:"text-2xl text-gray-500 hover:text-gray-700",children:"×"})]}),s.isApproved==="rejected"&&s.rejectionMessage&&e.jsx("div",{className:"mb-6 rounded-lg border border-red-200 bg-red-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx("svg",{className:"h-5 w-5 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.698-.833-2.464 0L4.232 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-red-800",children:"Rejection Reason"}),e.jsx("p",{className:"mt-1 whitespace-pre-wrap text-red-700",children:s.rejectionMessage}),e.jsx("div",{className:"mt-3",children:e.jsxs("p",{className:"text-sm text-red-600",children:[e.jsx("strong",{children:"Action required:"})," Please edit your service to address the issues mentioned above and resubmit for approval."]})})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"mb-4 h-64 rounded-lg bg-gray-200",children:s.videos?.length>0?e.jsx("video",{className:"h-full w-full rounded-lg object-cover",src:s.videos[0],controls:!0,autoPlay:!0}):e.jsx("img",{src:s.images?.[a],alt:s.title,className:"h-full w-full rounded-lg object-cover"})}),s.images?.length>1&&e.jsx("div",{className:"flex space-x-2 overflow-x-auto py-2",children:s.images.map((g,x)=>e.jsx("button",{onClick:()=>u(x),className:`h-16 w-16 rounded border-2 ${a===x?"border-blue-500":"border-gray-300"}`,children:e.jsx("img",{src:g,alt:`Thumbnail ${x+1}`,className:"h-full w-full rounded object-cover"})},x))})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-2 font-semibold text-gray-700",children:"Description"}),e.jsx("p",{className:"text-gray-600",children:s.description})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-2 font-semibold text-gray-700",children:"Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Price:"}),e.jsxs("span",{className:"font-semibold",children:["$",s.price]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Category:"}),e.jsx("span",{children:s.category})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Status:"}),e.jsx("span",{className:`rounded-full px-2 py-1 text-xs ${s.isApproved==="approved"?"bg-green-100 text-green-800":s.isApproved==="requested"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.isApproved})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Created:"}),e.jsx("span",{children:new Date(s.createdAt).toLocaleDateString()})]})]})]})]}),e.jsxs("div",{className:"mt-6 flex space-x-4 border-t border-gray-200 pt-6",children:[e.jsx("button",{className:"rounded-lg bg-blue-500 px-6 py-2 text-white transition-colors hover:bg-blue-600",children:"Edit Service"}),e.jsx("button",{onClick:h,className:"rounded-lg bg-gray-500 px-6 py-2 text-white transition-colors hover:bg-gray-600",children:"Close"})]})]})})}),ie=()=>{const s=P(),a=T(),u=C(l=>l.service.serviceTabActive),[h,g]=B(),x={0:"all",1:"create",2:"pending",3:"rejected"},f={all:0,create:1,pending:2,rejected:3};c.useEffect(()=>{const l=h.get("tab");l&&f[l]!==void 0?s(O(f[l])):g({tab:x[u]},{replace:!0})},[]),c.useEffect(()=>{const l=h.get("tab"),p=x[u];l!==p&&g({tab:p},{replace:!0})},[u,h,g]),c.useEffect(()=>{(async()=>{try{const p=await S.getAllServices();s(R(p.data.services))}catch{E.error("No services found")}})()},[s]);const i=()=>{let l="all";switch(u){case 0:l="all";break;case 2:l="requested";break;case 3:l="rejected";break;default:l="all"}switch(u){case 0:return e.jsx(A,{filter:l});case 1:return e.jsx(Q,{});case 2:return e.jsx(A,{filter:l});case 3:return e.jsx(A,{filter:l});default:return e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No service found"})}};return e.jsxs(V,{children:[e.jsxs("div",{onClick:()=>a("/dashboard"),className:"flex items-center gap-2 text-teal-600 underline hover:text-teal-700",children:[e.jsx(H,{})," ",e.jsx("div",{children:"back to dashboard"})]}),e.jsx(K,{}),i()]})};export{ie as default};
